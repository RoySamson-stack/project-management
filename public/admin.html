<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="popup.css">
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="main.css">
  <!-- box icon -->
  <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
  <div class="sidebar">
    <div class="logo_details">
      <i class='bx bx-code-alt'></i>
      <div class="logo_name">
        PROJECTMANG
      </div>
    </div>
    <ul>
      <li>
        <a href="#" class="active">
          <i class='bx bx-grid-alt'></i>
          <span class="links_name">
            Dashboard
          </span>
        </a>
      </li>
      <!-- <li>
        <a href="profile.html">
          <i class='bx bx-user'></i>
          <span class="links_name">
            Profile
          </span>
        </a> -->
      </li>
      <!-- <li>
        <a href="#">
          <i class='bx bx-cart-alt'></i>
          <span class="links_name">
            calendar
          </span>
        </a>
      </li> -->
      <li class="login">
        <!-- <a href="#">
          <span class="links_name login_out" id="dashboard">
            Login Out
          </span>
          <i class='bx bx-log-out' id="log_out"></i>
        </a> -->
         <div id="dashboard">
         <div id="userDetails"></div> 
        <button id="logout">Logout</button>
      </div> 
      </li>
    </ul>
  </div>
  <!-- End Sideber -->
  <section class="home_section">
    <div class="topbar">
      <div class="toggle">
        <i class='bx bx-menu' id="btn"></i>
      </div>
      <div class="search_wrapper">
        <label>
          <span>
            <i class='bx bx-search'></i>
          </span>
          <input type="search" placeholder="Search...">
        </label>
      </div>
      <div class="user_wrapper">
        <!-- <img src="img/user.jpg" alt=""> -->
      </div>
    </div>
    <!-- End Top Bar -->
 
    <!-- End Card Boxs -->
    <div class="details">
      <div class="recent_project">
        <div class="card_head">
          <h2>Teams</h2>
            <button id="btnOpenForm" class="fo odd_btnR" name="new_team">new team</button>
        </div>
        <table id="tbl_teams_list">
          <thead>
              <th>Team Name</th>
              <th>Team members</th>
              <th>Team lead</th>
          </thead>
        </table>
        <!-- <button id="btnOpenForm" class="fo" name="new_team">new team</button> -->

      </div>
      
      <div class="recent_customers">
        <div class="card_header">
          <h2>create team</h2>
        </div>
        <table id="tbl_users_lists">
          <thead>
            <th>Team lead</th>
            <th>Project</th>
        </thead>
          <!-- <tbody>      
          </tbody> -->

       </div> 
      </div>  

      <div class="form-popup-bg mem-team modal-dialog  modal-dialog-centered modal-lg">
          <div class="form-container">
            <button id="btnCloseForm" class="close-button">X</button>
            <form action="" id="form-team">
              <div class="form-group mb-3">
                <label for="">Program</label>
                <br>
                <input type="text" class="form-control" id="teamname" required/>
              </div>
              <div class="form-group mb-3">
                <label for="">Team Lead</label>
                <br>
                <input class="form-control" type="text" id="teamlead" required/>
              </div>
              <div class="form-group mb-3">
                <label for="">Team members</label>
                <br>
                <input class="form-control" type="text" id="teammemebers" required/>
              </div>
              <div class="form-group mb-3">
                <label for="">email</label>
                <br>
                <input class="form-control" type="text" id="email" required/>
              </div>
              <div class="form-group mb-3">
                <label for="">password</label>
                <br>
                <input class="form-control" type="password" id="password" required/>
              </div>
              <button  id="signup" class="form-btn">Submit</button>
            </form>
          </div>
        </div>
        </table>
      </div>
      <div class="recent_project">
        <div class="card_header">
          <h2>Projects</h2>
          <button id="btnOpenForm1" class="fo odd_btn" name="new_team">new Project</button>

        </div>
        <table id="tbl_projects_list">
          <thead>
              <th>Project Name</th>
              <th>Project description</th>
              <th>Assigned team</th>
          </thead>
         
        </table>
        
      </div>
      <div class="recent_customers">
        <div class="card_header">
          <h2>Completed project</h2>
        </div>
        <table id="tbl_users_list">
    
          <!-- <tbody>      
          </tbody> -->
        </div>
       
        <div class="form-popup-bg mem-team1 modal-dialog  modal-dialog-centered modal-lg">
          <div class="form-container">
            <button id="btnCloseForm" class="close-button">X</button>
            <form action="" id="form-team">
              <div class="form-group mb-3">
                <label for="">project</label>
                <br>
                <input type="text" class="form-control" id="projectname" required/>
              </div>
              <div class="form-group mb-3">
                <label for="">Project description</label>
                <br>
                <input class="form-control" type="text" id="projectdescription" required/>
              </div>
              <button  id="signup-pro" class="form-btn">Submit</button>
            </form>
          </div>
        </div>
      </div> 
      </div>  
      

        </table>
    </div>
  </section>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.9.4/firebase-app.js" ></script>
  <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-auth-compat.js"></script>
  <script>
     var config = {
        apiKey: "AIzaSyDmOzvLfbJ74Ftv0QWQmdpoaE1LzNPUlo0",
        authDomain: "project-management-53eab.firebaseapp.com",
        databaseURL: "https://project-management-53eab-default-rtdb.firebaseio.com",
        projectId: "project-management-53eab",
        storageBucket: "project-management-53eab.appspot.com",
        messagingSenderId: "61242591551",
        appId: "1:61242591551:web:d1707b994cb68028d1ab8a"
      };
      firebase.initializeApp(config);

   
    $(document).ready(function(){
              // teams js code
              firebase.firestore().collection('teams').get().then((snapshot) => {
                            snapshot.docs.forEach(doc => {
                                renderAccount(doc);
                            })
                        })

                        const teamList = document.querySelector('#tbl_teams_list') ;
                        function renderAccount(doc){
                            let tr = document.createElement('tr');
                            let td_email = document.createElement('td');
                            let td_full_name = document.createElement('td');
                            let td_uni_id = document.createElement('td');
                            var del_button = document.createElement("button");

                            let assign_btn = document.createElement("select")


                            del_button.data = "hi";
                            del_button.innerHTML = 'Delete';
                            del_button.className="del"
                            del_button.onclick = function()
                            {
                                // console.log("hello, world");
                                firebase.firestore().collection('teams').doc(doc.id).delete()
                              .then(() => {
                                  console.log('Data Deleted')
                              })
                              .catch((err) =>{
                                  console.log(err)
                              })
                             }
                        
                            tr.setAttribute('data-id', doc.id);
                            td_email.textContent = doc.data().teamname;
                            td_full_name.textContent = doc.data().teammembers;
                            td_uni_id.textContent = doc.data().teamlead;

                     
                            
                          
                            tr.appendChild(td_email);
                            tr.appendChild(td_full_name);
                            tr.appendChild(td_uni_id);
                            tr.appendChild(del_button)
                            tr.appendChild(assign_btn)

                            // tr.appendChild(td_uni_id)

                            teamList.appendChild(tr);

                        }
            })
            $(document).ready(function(){
              // teams js code
               // teams js code
               firebase.firestore().collection('projects').where('completed', "==", true).get().then((snapshot) => {
                            snapshot.docs.forEach(doc => {
                                renderAccount(doc);
                            })
                        })

                        const teamList = document.querySelector('#tbl_users_list') ;
                        function renderAccount(doc){
                            let tr = document.createElement('tr');
                            let td_email = document.createElement('td');
                            let td_full_name = document.createElement('td');
                            // let td_uni_id = document.createElement('td');
                            var check = document.createElement("input");
                          


                            tr.setAttribute('data-id', doc.id);
                            td_email.textContent = doc.data().projectname;
                            // td_full_name.textContent = doc.data().projectdescription;
                            // td_uni_id.textContent = doc.data().uni_id;
                            // check.data = "hi";
                            // check.type = 'checkbox'
                            // check.value = "Save"
                            // check.className = "add_btn"
                            // check.innerHTML = 'Save';
                            // check.onclick = function()
                            // {
                            //     // console.log("hello, world");
                            //     firebase.firestore().collection('projects').doc(doc.id).update({
                            //       'save':false,
                            //     })
                            //   .then(() => {
                            //       console.log('Data Saved')
                            //   })
                            //   .catch((err) =>{
                            //       console.log(err)
                            //   })
                            //  }

                            tr.appendChild(td_email);
                            tr.appendChild(td_full_name);
                            // tr.appendChild(check)
                            // tr.appendChild(td_uni_id);

                            teamList.appendChild(tr);

                 
                          }
            })



            $(document).ready(function(){
              // teams js code
              firebase.firestore().collection('projects').doc(doc.id).collection('comments').get().then((snapshot) => {
                            snapshot.docs.forEach(doc => {
                                renderAccount(doc);
                                
                            })
                        })

                        const teamList = document.querySelector('#tbl_users_lists') ;
                        function renderAccount(doc){
                            let tr = document.createElement('tr');
                            let td_email = document.createElement('td');
                            let td_full_name = document.createElement('td');
                            let td_uni_id = document.createElement('td');

                            tr.setAttribute('data-id', doc.id);
                            td_email.textContent = doc.data().comments;
                            // td_full_name.textContent = doc.data().teamlead;
                            // td_uni_id.textContent = doc.data().uni_id;

                            tr.appendChild(td_email);
                            // tr.appendChild(td_full_name);
                            // tr.appendChild(td_uni_id);

                            teamList.appendChild(tr);

                 
                          }
            })

            $(document).ready(function(){
              // teams js code
              firebase.firestore().collection('projects').get().then((snapshot) => {
                            snapshot.docs.forEach(doc => {
                                renderAccount(doc);
                            })
                        })

                        const teamList = document.querySelector('#tbl_projects_list') ;
                        function renderAccount(doc){
                            let tr = document.createElement('tr');
                            let td_email = document.createElement('td');
                            let td_full_name = document.createElement('td');
                            // let td_uni_id = document.createElement('td');
                            var del_button = document.createElement("button");
                           
                          


                            tr.setAttribute('data-id', doc.id);
                            td_email.textContent = doc.data().projectname;
                            td_full_name.textContent = doc.data().projectdescription;
                            // td_uni_id.textContent = doc.data().uni_id;
                            del_button.data = "hi";
                            del_button.innerHTML = 'Delete';
                            del_button.className="del"

                            del_button.onclick = function()
                            {
                                // console.log("hello, world");
                                firebase.firestore().collection('projects').doc(doc.id).delete()
                              .then(() => {
                                  console.log('Data Deleted')
                              })
                              .catch((err) =>{
                                  console.log(err)
                              })
                             }
                             
                            tr.appendChild(td_email);
                            tr.appendChild(td_full_name);
                            // tr.appendChild(del_button)
                            // tr.appendChild(td_uni_id);

                            teamList.appendChild(tr);

                 
                          }
            })


            document.getElementById('signup').addEventListener('click', signup)  

function signup(e) {
    const teamname = document.getElementById('teamname');
    const teamlead = document.getElementById('teamlead');
    const teammembers = document.getElementById('teammembers');
    const password = document.getElementById('password').value;
    const email = document.getElementById("email").value;

    firebase.auth().createUserWithEmailAndPassword(email, password)
        .then((result) => {
            // Signed in 
            document.write("You are Signed Up")
            console.log(result)
            // window.location='login.html'
            // ...
        })
        .catch((error) => {
            console.log(error.code);
            console.log(error.message)
            // ..
        });

    var  database = firebase.firestore();
    var userCollection = database.collection('teams');
    // ------------ Add Data to FireStore ---------------------------------------------//
    e.preventDefault();  
    userCollection.doc(teamname.value).set({ 
    teamname: teamname.value,
    teamlead: teamlead.value,
    teammemebers: teammembers.value,
    password: password.value,
    })
    .then(()=> {console.log('Data Successfully Written ');
    console.log(teamname, teamlead)
})
    .catch(error => {console.error(error)});
}

document.getElementById('signup-pro').addEventListener('click', signupPro)  

function signupPro(e) {
    const projectname = document.getElementById('projectname');
    const projectdescription = document.getElementById('projectdescription');

    var  database = firebase.firestore();
    var userCollection = database.collection('projects');
    // ------------ Add Data to FireStore ---------------------------------------------//
    e.preventDefault();  
    userCollection.doc(projectname.value).set({ 
    projectname: projectname.value,
    projectdescription: projectdescription.value,
    })
    .then(()=> {console.log('Data Successfully Written ');
    // console.log(teamname, teamlead)
})
    .catch(error => {console.error(error)});
}
  </script>
  <script src="popup.js"></script>
  <script src="index.js"></script>

</body>
</html>
