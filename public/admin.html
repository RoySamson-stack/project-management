<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="popup.css">
  <!-- <link rel="stylesheet" href="index.css"> -->
  <link rel="stylesheet" href="main.css">
  <!-- box icon -->
  <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
  <div class="sidebar">
    <div class="logo_details">
      <i class='bx bx-code-alt'></i>
      <div class="logo_name">
        End Dev
      </div>
    </div>
    <ul>
      <li>
        <a href="#" class="active">
          <i class='bx bx-grid-alt'></i>
          <span class="links_name">
            Dashboard
          </span>
        </a>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-user'></i>
          <span class="links_name">
            Profile
          </span>
        </a>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-cart-alt'></i>
          <span class="links_name">
            calendar
          </span>
        </a>
      </li>
      <li class="login">
        <!-- <a href="#">
          <span class="links_name login_out" id="dashboard">
            Login Out
          </span>
          <i class='bx bx-log-out' id="log_out"></i>
        </a> -->
         <div id="dashboard">
         <div id="userDetails"></div> 
        <button id="logout">Logout</button>
      </div> 
      </li>
    </ul>
  </div>
  <!-- End Sideber -->
  <section class="home_section">
    <div class="topbar">
      <div class="toggle">
        <i class='bx bx-menu' id="btn"></i>
      </div>
      <div class="search_wrapper">
        <label>
          <span>
            <i class='bx bx-search'></i>
          </span>
          <input type="search" placeholder="Search...">
        </label>
      </div>
      <div class="user_wrapper">
        <!-- <img src="img/user.jpg" alt=""> -->
      </div>
    </div>
    <!-- End Top Bar -->
 
    <!-- End Card Boxs -->
    <div class="details">
      <div class="recent_project">
        <div class="card_header">
          <h2>Teams</h2>
        </div>
        <table id="tbl_teams_list" border="2"  style="border-collapse:collapse;" class="admin-table">
          <thead>
              <th>team name</th>
              <th>team members</th>
              <th>assigned</th>
               <th>team lead</th>  
          </thead>
        </table>
        <button id="btnOpenForm" class="fo" name="new_team">new team</button>

      </div>
      
      <div class="recent_customers">
        <div class="card_header">
          <h2>Team leads</h2>
        </div>
        <table id="tbl_users_list">
          <tbody>      
          </tbody>
       </div> 
      </div> 
      <div class="form-popup-bg modal-dialog  modal-dialog-centered modal-lg">
          <div class="form-container">
            <button id="btnCloseForm" class="close-button">X</button>
            <form action="" id="form-team">
              <div class="form-group mb-3">
                <label for="">Team name</label>
                <br>
                <input type="text" class="form-control" id="teamname" required/>
              </div>
              <div class="form-group mb-3">
                <label for="">Team members</label>
                <br>
                <input class="form-control" type="text" id="teamlead" required/>
              </div>
              <button  id="signup" class="form-btn">Submit</button>
            </form>
          </div>
        </div>
        </table>
      </div>
      <div class="recent_project">
        <div class="card_header">
          <h2>Latest Projects</h2>
        </div>
        <table id="tbl_projects_list" border="2"  style="border-collapse:collapse;" class="admin-table">
          <thead>
              <th>project name</th>
            <th>project description</th>
              <!-- <th>assigned</th> -->
               <!-- <th>UNI_ID</th>   -->
          </thead>
        </table>
      </div>
    </div>
  </section>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.9.4/firebase-app.js" ></script>
  <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-auth-compat.js"></script>
  <script>
     var config = {
        apiKey: "AIzaSyDmOzvLfbJ74Ftv0QWQmdpoaE1LzNPUlo0",
        authDomain: "project-management-53eab.firebaseapp.com",
        databaseURL: "https://project-management-53eab-default-rtdb.firebaseio.com",
        projectId: "project-management-53eab",
        storageBucket: "project-management-53eab.appspot.com",
        messagingSenderId: "61242591551",
        appId: "1:61242591551:web:d1707b994cb68028d1ab8a"
      };
      firebase.initializeApp(config);

   
    $(document).ready(function(){
              // teams js code
              firebase.firestore().collection('teams').get().then((snapshot) => {
                            snapshot.docs.forEach(doc => {
                                renderAccount(doc);
                            })
                        })

                        const teamList = document.querySelector('#tbl_teams_list') ;
                        function renderAccount(doc){
                            let tr = document.createElement('tr');
                            let td_email = document.createElement('td');
                            let td_full_name = document.createElement('td');
                            let td_uni_id = document.createElement('td');

                            tr.setAttribute('data-id', doc.id);
                            td_email.textContent = doc.data().teamname;
                            td_full_name.textContent = doc.data().teamlead;
                            td_uni_id.textContent = doc.data().teamleader;

                            tr.appendChild(td_email);
                            tr.appendChild(td_full_name);
                            tr.appendChild(td_uni_id);
                            // tr.appendChild(td_uni_id)

                            teamList.appendChild(tr);

                        }
            })
            $(document).ready(function(){
              // teams js code
              firebase.firestore().collection('users').get().then((snapshot) => {
                            snapshot.docs.forEach(doc => {
                                renderAccount(doc);
                            })
                        })

                        const teamList = document.querySelector('#tbl_users_list') ;
                        function renderAccount(doc){
                            let tr = document.createElement('tr');
                            let td_email = document.createElement('h4');
                            let td_full_name = document.createElement('td');
                            let td_uni_id = document.createElement('td');

                            tr.setAttribute('data-id', doc.id);
                            td_email.textContent = doc.data().name;
                            td_full_name.textContent = doc.data().teamlead;
                            td_uni_id.textContent = doc.data().uni_id;

                            tr.appendChild(td_email);
                            tr.appendChild(td_full_name);
                            tr.appendChild(td_uni_id);

                            teamList.appendChild(tr);

                 
                          }
            })

            $(document).ready(function(){
              // teams js code
              firebase.firestore().collection('projects').get().then((snapshot) => {
                            snapshot.docs.forEach(doc => {
                                renderAccount(doc);
                            })
                        })

                        const teamList = document.querySelector('#tbl_projects_list') ;
                        function renderAccount(doc){
                            let tr = document.createElement('tr');
                            let td_email = document.createElement('td');
                            let td_full_name = document.createElement('td');
                            // let td_uni_id = document.createElement('td');

                            tr.setAttribute('data-id', doc.id);
                            td_email.textContent = doc.data().projectname;
                            td_full_name.textContent = doc.data().projectdescription;
                            // td_uni_id.textContent = doc.data().uni_id;

                            tr.appendChild(td_email);
                            tr.appendChild(td_full_name);
                            // tr.appendChild(td_uni_id);

                            teamList.appendChild(tr);

                 
                          }
            })


            document.getElementById('signup').addEventListener('click', signup)  

function signup(e) {
    const teamname = document.getElementById('teamname');
    const teamlead = document.getElementById('teamlead');

    var  database = firebase.firestore();
    var userCollection = database.collection('teams');
    // ------------ Add Data to FireStore ---------------------------------------------//
    e.preventDefault();  
    userCollection.doc(teamname.value).set({ 
    teamname: teamname.value,
    teamlead: teamlead.value,
    })
    .then(()=> {console.log('Data Successfully Written ');
    console.log(teamname, teamlead)
})
    .catch(error => {console.error(error)});
}
  </script>
  <script src="popup.js"></script>
  <script src="index.js"></script>

</body>
</html>
